{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sriko\\\\OneDrive\\\\Desktop\\\\submision\\\\src\\\\components\\\\RedirectHandler.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { getShortenedUrlByCode, updateClicksForShortcode } from '../utils/storage';\nimport Logger from '../logging/Logger';\nimport { getLocation } from '../utils/geolocation';\nimport { Box, Typography, CircularProgress } from '@mui/material';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction RedirectHandler() {\n  _s();\n  const {\n    shortcode\n  } = useParams();\n  const navigate = useNavigate();\n  useEffect(() => {\n    const urlObj = getShortenedUrlByCode(shortcode);\n    if (!urlObj) {\n      Logger.log('Redirection failed: shortcode not found', {\n        shortcode\n      });\n      navigate('/', {\n        replace: true,\n        state: {\n          error: 'Shortcode not found or expired.'\n        }\n      });\n      return;\n    }\n    const now = new Date();\n    if (new Date(urlObj.expiresAt) < now) {\n      Logger.log('Redirection failed: shortcode expired', {\n        shortcode\n      });\n      navigate('/', {\n        replace: true,\n        state: {\n          error: 'Shortcode expired.'\n        }\n      });\n      return;\n    }\n    // Log click\n    getLocation().then(location => {\n      updateClicksForShortcode(shortcode, {\n        timestamp: now.toISOString(),\n        source: document.referrer || 'direct',\n        location: location || 'unknown'\n      });\n      Logger.log('Short URL clicked', {\n        shortcode,\n        location\n      });\n      window.location.href = urlObj.originalUrl;\n    });\n  }, [shortcode, navigate]);\n  return /*#__PURE__*/_jsxDEV(Box, {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    mt: 8,\n    children: [/*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h6\",\n      mt: 2,\n      children: \"Redirecting...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 5\n  }, this);\n}\n_s(RedirectHandler, \"TKffyDUDAJyR49DhLMLwuaUA4lY=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = RedirectHandler;\nexport default RedirectHandler;\nvar _c;\n$RefreshReg$(_c, \"RedirectHandler\");","map":{"version":3,"names":["React","useEffect","useNavigate","useParams","getShortenedUrlByCode","updateClicksForShortcode","Logger","getLocation","Box","Typography","CircularProgress","jsxDEV","_jsxDEV","RedirectHandler","_s","shortcode","navigate","urlObj","log","replace","state","error","now","Date","expiresAt","then","location","timestamp","toISOString","source","document","referrer","window","href","originalUrl","display","flexDirection","alignItems","mt","children","fileName","_jsxFileName","lineNumber","columnNumber","variant","_c","$RefreshReg$"],"sources":["C:/Users/sriko/OneDrive/Desktop/submision/src/components/RedirectHandler.js"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { getShortenedUrlByCode, updateClicksForShortcode } from '../utils/storage';\nimport Logger from '../logging/Logger';\nimport { getLocation } from '../utils/geolocation';\nimport { Box, Typography, CircularProgress } from '@mui/material';\n\nfunction RedirectHandler() {\n  const { shortcode } = useParams();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const urlObj = getShortenedUrlByCode(shortcode);\n    if (!urlObj) {\n      Logger.log('Redirection failed: shortcode not found', { shortcode });\n      navigate('/', { replace: true, state: { error: 'Shortcode not found or expired.' } });\n      return;\n    }\n    const now = new Date();\n    if (new Date(urlObj.expiresAt) < now) {\n      Logger.log('Redirection failed: shortcode expired', { shortcode });\n      navigate('/', { replace: true, state: { error: 'Shortcode expired.' } });\n      return;\n    }\n    // Log click\n    getLocation().then(location => {\n      updateClicksForShortcode(shortcode, {\n        timestamp: now.toISOString(),\n        source: document.referrer || 'direct',\n        location: location || 'unknown',\n      });\n      Logger.log('Short URL clicked', { shortcode, location });\n      window.location.href = urlObj.originalUrl;\n    });\n  }, [shortcode, navigate]);\n\n  return (\n    <Box display=\"flex\" flexDirection=\"column\" alignItems=\"center\" mt={8}>\n      <CircularProgress />\n      <Typography variant=\"h6\" mt={2}>Redirecting...</Typography>\n    </Box>\n  );\n}\n\nexport default RedirectHandler;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,SAASC,WAAW,EAAEC,SAAS,QAAQ,kBAAkB;AACzD,SAASC,qBAAqB,EAAEC,wBAAwB,QAAQ,kBAAkB;AAClF,OAAOC,MAAM,MAAM,mBAAmB;AACtC,SAASC,WAAW,QAAQ,sBAAsB;AAClD,SAASC,GAAG,EAAEC,UAAU,EAAEC,gBAAgB,QAAQ,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAElE,SAASC,eAAeA,CAAA,EAAG;EAAAC,EAAA;EACzB,MAAM;IAAEC;EAAU,CAAC,GAAGZ,SAAS,CAAC,CAAC;EACjC,MAAMa,QAAQ,GAAGd,WAAW,CAAC,CAAC;EAE9BD,SAAS,CAAC,MAAM;IACd,MAAMgB,MAAM,GAAGb,qBAAqB,CAACW,SAAS,CAAC;IAC/C,IAAI,CAACE,MAAM,EAAE;MACXX,MAAM,CAACY,GAAG,CAAC,yCAAyC,EAAE;QAAEH;MAAU,CAAC,CAAC;MACpEC,QAAQ,CAAC,GAAG,EAAE;QAAEG,OAAO,EAAE,IAAI;QAAEC,KAAK,EAAE;UAAEC,KAAK,EAAE;QAAkC;MAAE,CAAC,CAAC;MACrF;IACF;IACA,MAAMC,GAAG,GAAG,IAAIC,IAAI,CAAC,CAAC;IACtB,IAAI,IAAIA,IAAI,CAACN,MAAM,CAACO,SAAS,CAAC,GAAGF,GAAG,EAAE;MACpChB,MAAM,CAACY,GAAG,CAAC,uCAAuC,EAAE;QAAEH;MAAU,CAAC,CAAC;MAClEC,QAAQ,CAAC,GAAG,EAAE;QAAEG,OAAO,EAAE,IAAI;QAAEC,KAAK,EAAE;UAAEC,KAAK,EAAE;QAAqB;MAAE,CAAC,CAAC;MACxE;IACF;IACA;IACAd,WAAW,CAAC,CAAC,CAACkB,IAAI,CAACC,QAAQ,IAAI;MAC7BrB,wBAAwB,CAACU,SAAS,EAAE;QAClCY,SAAS,EAAEL,GAAG,CAACM,WAAW,CAAC,CAAC;QAC5BC,MAAM,EAAEC,QAAQ,CAACC,QAAQ,IAAI,QAAQ;QACrCL,QAAQ,EAAEA,QAAQ,IAAI;MACxB,CAAC,CAAC;MACFpB,MAAM,CAACY,GAAG,CAAC,mBAAmB,EAAE;QAAEH,SAAS;QAAEW;MAAS,CAAC,CAAC;MACxDM,MAAM,CAACN,QAAQ,CAACO,IAAI,GAAGhB,MAAM,CAACiB,WAAW;IAC3C,CAAC,CAAC;EACJ,CAAC,EAAE,CAACnB,SAAS,EAAEC,QAAQ,CAAC,CAAC;EAEzB,oBACEJ,OAAA,CAACJ,GAAG;IAAC2B,OAAO,EAAC,MAAM;IAACC,aAAa,EAAC,QAAQ;IAACC,UAAU,EAAC,QAAQ;IAACC,EAAE,EAAE,CAAE;IAAAC,QAAA,gBACnE3B,OAAA,CAACF,gBAAgB;MAAA8B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eACpB/B,OAAA,CAACH,UAAU;MAACmC,OAAO,EAAC,IAAI;MAACN,EAAE,EAAE,CAAE;MAAAC,QAAA,EAAC;IAAc;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAY,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACxD,CAAC;AAEV;AAAC7B,EAAA,CAnCQD,eAAe;EAAA,QACAV,SAAS,EACdD,WAAW;AAAA;AAAA2C,EAAA,GAFrBhC,eAAe;AAqCxB,eAAeA,eAAe;AAAC,IAAAgC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}